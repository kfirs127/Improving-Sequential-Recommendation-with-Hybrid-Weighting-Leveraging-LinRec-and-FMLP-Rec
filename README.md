# Improving Sequential Recommendation with Hybrid Weighting

This project is part of the Recommendation Systems course and presents a hybrid sequential recommendation model that combines two state-of-the-art approaches—**LinRec** (a linear attention mechanism) and **FMLP-Rec** (an MLP-based model with frequency-domain filtering). By integrating these techniques with an adaptive gating mechanism, the model achieves near-linear runtime while effectively capturing long-term dependencies and mitigating noise in user interaction sequences.

---

## Project Overview

Modern recommendation systems require balancing efficiency with the ability to capture both short-term and long-term user behaviors. Traditional Transformer-based models, while powerful, suffer from quadratic complexity which limits their scalability. This project, developed as part of a Recommendation System course, addresses these challenges by:

- **Integrating LinRec and FMLP-Rec:**
  - **LinRec** efficiently models global dependencies via a linearized attention mechanism.  [LinRec Repository](https://github.com/Applied-Machine-Learning-Lab/LinRec)
  - **FMLP-Rec** leverages frequency-domain filtering to extract periodic patterns and reduce noise.  [FMLP Repository](https://github.com/Woeee/FMLP-Rec/)
  
- **Adaptive Gating Mechanism:**
  - A lightweight neural network computes a dynamic weighting parameter based on statistical sequence-based features.
  - This parameter balances the contributions of LinRec and FMLP-Rec to yield the final recommendation ranking.

- **Scalability & Efficiency:**
  - The hybrid approach maintains near-linear computational complexity, making it well-suited for large-scale recommendation tasks.

---

## Architecture & Methodology

### Hybrid Model Structure
- **Processing:**
  - The model processes user interaction sequences simultaneously through both the LinRec and FMLP-Rec branches.
  
- **Adaptive Fusion:**
  - A gating network computes a weighting parameter (α) from sequence-based statistical features.
  - The final recommendation list is generated by dynamically blending the outputs from both branches based on α.

### Key Components
- **LinRec Branch:**
  - Utilizes normalized query, key, and value matrices.
  - Performs efficient dot-product operations to capture long-range dependencies without quadratic overhead.
  
- **FMLP-Rec Branch:**
  - Applies a Fast Fourier Transform (FFT) to the input sequence.
  - Filters frequency components with learnable weights, then performs an Inverse FFT (IFFT) to recover denoised embeddings.
  
- **Fusion Strategy:**
  - The adaptive gating mechanism combines the two branches’ outputs to generate the final ranked recommendations.

---

## Experimental Evaluation

The hybrid model is evaluated on benchmark datasets, including Amazon Beauty and MovieLens-1M, using standard metrics:

- **Mean Reciprocal Rank (MRR)**
- **Normalized Discounted Cumulative Gain (NDCG)**

Experimental results demonstrate that the hybrid model:
- Exceeds the performance of standalone LinRec and FMLP-Rec models on the ML1M dataset .
- Exceeds the performance of standalone LinRec and matches the performance of FMLP-Rec on the Beauty dataset .

